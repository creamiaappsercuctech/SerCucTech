<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Apri Vetrina</title>
  <link rel="stylesheet" href="style.css?v=1">
  <style>
    body{padding:18px}
    .cardx{
      max-width:720px;margin:0 auto;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.18);
      border-radius:18px;padding:14px;display:grid;gap:12px
    }
    .h{font-weight:1000;font-size:20px;margin:0}
    .p{opacity:.9;margin:0;font-weight:800;line-height:1.35}
    .btn{
      width:100%;border:none;border-radius:16px;
      padding:14px 12px;font-weight:1000;cursor:pointer
    }
    .btn:active{transform:scale(.99)}
    .primary{background:#25D366;color:#06210f}
    .ghost{background:rgba(255,255,255,.10);color:#fff;border:1px solid rgba(255,255,255,.16)}
    .row{display:grid;gap:10px}
    .small{font-size:12px;opacity:.85;font-weight:900}
  </style>
</head>
<body>
  <div class="cardx">
    <h1 class="h" id="t">Caricamentoâ€¦</h1>
    <p class="p" id="d"></p>

    <div class="row">
      <button class="btn primary" id="openV">âœ… Apri la vetrina</button>
      <button class="btn ghost" id="openIndex">ðŸ”— Vedi indice vetrine</button>
      <button class="btn ghost" id="copy">ðŸ“‹ Copia link da condividere</button>
    </div>

    <div class="small" id="s"></div>
  </div>

<script>
(async function(){
  const sp = new URLSearchParams(location.search);
  const id = (sp.get("id") || "").trim() || "renzo11";

  const base = location.origin + location.pathname.replace(/link\.html$/,"");
  const share = `${base}link.html?id=${encodeURIComponent(id)}`;
  const vetrina = `${base}vetrina.html?id=${encodeURIComponent(id)}`;
  const index = `${base}index.html`;

  document.getElementById("openV").onclick = ()=> location.href = vetrina;
  document.getElementById("openIndex").onclick = ()=> location.href = index;
  document.getElementById("copy").onclick = async ()=>{
    try{
      await navigator.clipboard.writeText(share);
      alert("Link copiato âœ…");
    }catch(e){
      prompt("Copia questo link:", share);
    }
  };

  // prova a leggere titolo/desc dal JSON
  try{
    const r = await fetch(`data/${encodeURIComponent(id)}.json`, {cache:"no-store"});
    const j = await r.json();
    document.getElementById("t").textContent = j.title || ("Vetrina " + id);
    document.getElementById("d").textContent = j.description || "";
  }catch(e){
    document.getElementById("t").textContent = "Vetrina " + id;
  }

  document.getElementById("s").textContent =
    "Link pubblico: " + share + "\\n" +
    "Link diretto: " + vetrina;
})();
</script>
</body>
</html>
