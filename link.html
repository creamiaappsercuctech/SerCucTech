<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>SerCucTech ‚Äî Link Vetrina</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:rgba(255,255,255,.06);
      --line:rgba(255,255,255,.12);
      --txt:#eaf0ff;
      --muted:rgba(234,240,255,.72);
      --btn:rgba(255,255,255,.10);
      --green:#23c55e;
      --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(900px 600px at 20% -20%, rgba(130,170,255,.20), transparent 60%),
        radial-gradient(900px 600px at 90% 10%, rgba(120,255,210,.10), transparent 60%),
        var(--bg);
      color:var(--txt);
      padding:14px;
      padding-bottom:120px;
    }
    .wrap{max-width:720px;margin:0 auto;display:grid;gap:12px}
    .top{
      border:1px solid var(--line);
      background:var(--card);
      border-radius:18px;
      padding:14px;
      box-shadow:var(--shadow);
      text-align:center;
    }
    h1{margin:0;font-size:20px;font-weight:1000}
    .sub{margin-top:8px;color:var(--muted);font-weight:900;line-height:1.35}
    .card{
      border:1px solid var(--line);
      background:var(--card);
      border-radius:18px;
      padding:14px;
      box-shadow:var(--shadow);
    }
    .pill{
      display:inline-block;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--muted);
      font-weight:900;
      font-size:12px;
    }
    .row{display:grid;gap:10px}
    .btn{
      border:1px solid var(--line);
      background:var(--btn);
      color:var(--txt);
      border-radius:16px;
      padding:14px 14px;
      font-weight:1000;
      cursor:pointer;
      text-align:center;
      user-select:none;
    }
    .btn:active{transform:scale(.99)}
    .btnSolid{
      border:none;
      background:var(--green);
      color:#06110a;
      border-radius:16px;
      padding:14px 14px;
      font-weight:1000;
      cursor:pointer;
      text-align:center;
      user-select:none;
    }
    .btnSolid:active{transform:scale(.99)}
    .waBtn{
      border:none;
      background:#25D366;
      color:#06210f;
      border-radius:16px;
      padding:14px 14px;
      font-weight:1000;
      cursor:pointer;
      text-align:center;
      user-select:none;
    }
    .waBtn:active{transform:scale(.99)}
    .small{
      color:var(--muted);
      font-size:12px;
      font-weight:900;
      line-height:1.35;
    }
    .mono{
      margin-top:6px;
      padding:12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.22);
      font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size:12px;
      color:rgba(234,240,255,.88);
      word-break:break-word;
    }
    .bar{
      position:fixed; left:0; right:0; bottom:0;
      padding:10px 12px;
      background:linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.55));
      backdrop-filter:blur(10px);
      border-top:1px solid var(--line);
      display:flex;
      justify-content:center;
      z-index:999;
    }
    .barInner{width:min(720px,100%);display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:520px){ .barInner{grid-template-columns:1fr} }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <h1 id="title">SerCucTech ‚Äî Vetrina</h1>
      <div class="sub">
        Questa √® la pagina pi√π facile da condividere.<br>
        Premi WhatsApp per inviare un messaggio gi√† pronto.
      </div>
      <div style="margin-top:10px">
        <span class="pill">ID: <span id="idPill">‚Äî</span></span>
      </div>
    </div>

    <div class="card">
      <div style="font-weight:1000;margin-bottom:8px">üîó Link completo (da copiare)</div>
      <div class="mono" id="fullLink">‚Äî</div>
      <div class="row" style="margin-top:10px">
        <button class="btn" id="copyLinkBtn">üìã Copia link</button>
      </div>
      <div class="small" style="margin-top:8px">
        Suggerimento: copia il link e incollalo dove vuoi (WhatsApp, SMS, Facebook‚Ä¶).
      </div>
    </div>

    <div class="card">
      <div style="font-weight:1000;margin-bottom:8px">üü¢ WhatsApp con messaggio pronto</div>
      <div class="row">
        <button class="waBtn" id="openWaBtn">üü¢ Apri WhatsApp (testo gi√† pronto)</button>
        <button class="btnSolid" id="copyMsgBtn">üìå Copia messaggio WhatsApp</button>
      </div>
      <div class="small" style="margin-top:8px">
        Il messaggio dice: ‚ÄúDimmi il numero dell‚Äôoggetto che ti interessa‚Äù.
      </div>
    </div>

    <div class="card">
      <div style="font-weight:1000;margin-bottom:8px">üñºÔ∏è Apri la vetrina</div>
      <div class="row">
        <a class="btnSolid" id="openVetrinaBtn" href="#">Apri vetrina</a>
      </div>
      <div class="small" style="margin-top:8px">
        Qui si vedono foto, numerini sugli oggetti e audio.
      </div>
    </div>

    <div class="card">
      <div style="font-weight:1000;margin-bottom:8px">‚ÑπÔ∏è Mini spiegazione (10 anni)</div>
      <div class="small">
        Questa pagina serve solo per <b>condividere</b> facile.<br>
        Chi la apre trova subito i pulsanti giusti.<br>
        La vetrina vera √® ‚ÄúApri vetrina‚Äù.
      </div>
    </div>
  </div>

  <div class="bar">
    <div class="barInner">
      <button class="btn" id="shareNativeBtn">üì§ Condividi (menu telefono)</button>
      <button class="btn" id="copyAllBtn">üìã Copia (link + messaggio)</button>
    </div>
  </div>

<script>
(function(){
"use strict";

function qs(name){
  return new URLSearchParams(location.search).get(name);
}

const id = (qs("id") || "").trim() || "renzo11";

const idPill = document.getElementById("idPill");
const fullLinkEl = document.getElementById("fullLink");
const copyLinkBtn = document.getElementById("copyLinkBtn");

const openWaBtn = document.getElementById("openWaBtn");
const copyMsgBtn = document.getElementById("copyMsgBtn");

const openVetrinaBtn = document.getElementById("openVetrinaBtn");

const shareNativeBtn = document.getElementById("shareNativeBtn");
const copyAllBtn = document.getElementById("copyAllBtn");

idPill.textContent = id;

const base = location.origin + location.pathname.replace(/link\.html$/,"");
const link = `${base}link.html?id=${encodeURIComponent(id)}`;
const vetrinaLink = `${base}vetrina.html?id=${encodeURIComponent(id)}`;

fullLinkEl.textContent = link;
openVetrinaBtn.href = vetrinaLink;

function makeWhatsAppMessage(id){
  const clean = (id||"renzo11").trim() || "renzo11";
  const link = `${base}link.html?id=${encodeURIComponent(clean)}`;
  return `Ciao! üëã
Ti mando la vetrina con foto e numeri degli oggetti.

‚úÖ Apri qui:
${link}

üìå Se ti interessa un oggetto, dimmi il numero e ti rispondo subito su WhatsApp.`;
}

async function copyText(text){
  try{
    await navigator.clipboard.writeText(text);
    return true;
  }catch(e){
    return false;
  }
}

copyLinkBtn.addEventListener("click", async ()=>{
  const ok = await copyText(link);
  alert(ok ? "Link copiato ‚úÖ" : "Copia non riuscita. Tieni premuto sul testo e copia manualmente.");
});

copyMsgBtn.addEventListener("click", async ()=>{
  const msg = makeWhatsAppMessage(id);
  const ok = await copyText(msg);
  alert(ok ? "Messaggio copiato ‚úÖ" : "Copia non riuscita.");
});

openWaBtn.addEventListener("click", ()=>{
  const msg = makeWhatsAppMessage(id);
  const url = `https://wa.me/?text=${encodeURIComponent(msg)}`;
  window.open(url, "_blank");
});

shareNativeBtn.addEventListener("click", async ()=>{
  const msg = makeWhatsAppMessage(id);
  if(navigator.share){
    try{
      await navigator.share({
        title: "Vetrina",
        text: msg,
        url: link
      });
    }catch(e){}
  }else{
    alert("Condivisione non disponibile. Usa i bottoni copia/WhatsApp.");
  }
});

copyAllBtn.addEventListener("click", async ()=>{
  const msg = makeWhatsAppMessage(id);
  const all = `${msg}\n\n---\nLink diretto:\n${link}`;
  const ok = await copyText(all);
  alert(ok ? "Copiato (messaggio + link) ‚úÖ" : "Copia non riuscita.");
});

// titolo pagina (carico titolo da JSON se esiste)
(async ()=>{
  try{
    const res = await fetch(`data/${encodeURIComponent(id)}.json`, {cache:"no-store"});
    if(res.ok){
      const j = await res.json();
      const t = (j.title || "").trim();
      if(t){
        document.getElementById("title").textContent = t;
        document.title = t + " ‚Äî Link";
      }
    }
  }catch(e){}
})();
})();
</script>
</body>
</html>
