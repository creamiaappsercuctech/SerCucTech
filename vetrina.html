<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Vetrina</title>

  <!-- puoi usare stile.css o style.css: con il ponte, vanno entrambi -->
  <link rel="stylesheet" href="stile.css?v=1">
</head>

<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brandDot" aria-hidden="true"></div>

      <div class="titleWrap">
        <h1 id="pageTitle" class="pageTitle">Caricamento‚Ä¶</h1>
        <p id="pageDesc" class="pageDesc"></p>
      </div>

      <span id="badgeId" class="idBadge">id: -</span>
    </div>

    <!-- TESTO AUDIO FISSO + CONTATTI -->
    <section class="voicePanel" id="voicePanel" hidden>
      <div class="voicePanelInner" id="voicePanelInner" title="Tocca per ascoltare">
        <div class="voiceTop">
          <div class="voiceTitle">üì£ Messaggio (tocca qui per ascoltare)</div>
          <div class="voiceHint">Numeri cliccabili: WhatsApp / chiamata</div>
        </div>

        <div class="voiceText" id="voiceText"></div>
        <div class="contactsRow" id="contactsRow"></div>
        <div class="contactsHint">üëâ Tocca un numero per contattare subito</div>
      </div>
    </section>

    <!-- INDICE ALTRE VETRINE (caricato da data/vetrine.json) -->
    <section class="indexPanel" id="indexPanel" hidden>
      <div class="indexPanelInner">
        <div class="indexHead">
          <div class="indexTitle">üîó Altre vetrine</div>
          <button class="indexBtn" id="indexReloadBtn" type="button">Aggiorna</button>
        </div>
        <div class="indexHint">Tocca una vetrina per aprirla</div>
        <div class="indexList" id="indexList"></div>
      </div>
    </section>
  </header>

  <main class="content">
    <!-- GALLERIA -->
    <section class="card heroCard">
      <div class="hero">
        <button class="navBtn left" id="prevBtn" aria-label="Immagine precedente" type="button">‚Äπ</button>

        <div class="mediaStage" id="mediaStage">
          <div class="imgCounter" id="imgCounter">01/01</div>

          <div class="imgWrap" id="imgWrap">
            <img id="heroImg" class="heroImg" alt="Immagine vetrina">
            <div id="pinsLayer" class="pinsLayer" aria-hidden="true"></div>

            <!-- bottone whatsapp sopra foto -->
            <button class="waOnPhoto" id="waOnPhotoBtn" type="button">WhatsApp: chiedi info su questa foto</button>
          </div>

          <div class="imgBadge" id="imgBadge">01</div>
        </div>

        <button class="navBtn right" id="nextBtn" aria-label="Immagine successiva" type="button">‚Ä∫</button>
      </div>

      <div class="thumbRow" id="thumbRow"></div>

      <!-- azioni foto -->
      <div class="photoActions" style="display:flex;justify-content:center;margin-top:10px;gap:10px;flex-wrap:wrap">
        <button class="barBtn" id="editPhotoBtn" type="button">üß∑ Metti numerini (modifica foto)</button>
        <button class="barBtn" id="openImgBtn" type="button">üîé Apri immagine</button>
      </div>

      <div class="smallHint">
        Swipe sull‚Äôimmagine ‚Ä¢ Tap = schermo intero ‚Ä¢ Tap di nuovo = normale
      </div>
    </section>

    <!-- FILES (se li aggiungi nel JSON) -->
    <section class="card" id="filesCard" hidden>
      <h2 class="h2">Files</h2>
      <div id="filesList" class="filesList"></div>
    </section>
  </main>

  <!-- SHARE sopra la barra -->
  <div class="shareDock">
    <button class="shareBtn" id="shareBtn" type="button">Condividi questa vetrina</button>
  </div>

  <!-- BOTTOM BAR fissa -->
  <nav class="bottombar" id="bottombar">
    <button class="barBtn" id="homeBtn" type="button">Home</button>
    <button class="barBtn" id="voiceBtn" type="button">Voice</button>
    <button class="barBtn danger" id="stopBtn" type="button">Stop</button>
    <button class="barBtn" id="fullBtn" type="button">Full</button>
    <button class="barBtn" id="themeBtn" type="button">Tema</button>
    <button class="barBtn" id="kioskBtn" type="button">Kiosk</button>
  </nav>

  <!-- OVERLAY audio sblocco (non blocca click grazie al CSS) -->
  <div class="audioGate" id="audioGate" hidden>
    <div class="audioGateCard">
      <div class="audioGateTitle">Audio bloccato dal telefono</div>
      <div class="audioGateText">Tocca ‚ÄúAttiva audio‚Äù. Poi partir√† automaticamente.</div>
      <div class="audioGateBtns">
        <button class="primary" id="enableAudioBtn" type="button">Attiva audio</button>
        <button class="ghost" id="skipAudioBtn" type="button">Non ora</button>
      </div>
    </div>
  </div>

  <!-- MODAL EDIT FOTO -->
  <div class="waModal" id="editModal" hidden>
    <div class="waModalCard" style="width:min(980px, 96vw)">
      <div class="waModalTitle">üß∑ Editor numerini (tap sulla foto per aggiungere)</div>
      <div class="waModalText" id="editHint">
        1) Tocca sulla foto per piazzare numeri 1,2,3‚Ä¶<br>
        2) Cambia grandezza se serve<br>
        3) Quando finito: Scarica PNG oppure Salva su GitHub (opzionale)
      </div>

      <div style="border:1px solid rgba(255,255,255,.12);border-radius:16px;overflow:hidden;background:rgba(0,0,0,.2)">
        <canvas id="editCanvas" style="width:100%;height:auto;display:block"></canvas>
      </div>

      <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:10px">
        <button class="barBtn" id="undoPinBtn" type="button">‚Ü©Ô∏è Undo</button>
        <button class="barBtn danger" id="clearPinsBtn" type="button">üßπ Clear</button>

        <div style="display:flex;align-items:center;gap:10px;flex:1;min-width:220px">
          <span style="font-weight:900">Grandezza</span>
          <input id="pinSize" type="range" min="14" max="72" value="28" style="width:220px">
          <span id="pinSizeVal" style="min-width:56px;font-weight:900">28px</span>
        </div>
      </div>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
        <button class="barBtn" id="downloadPngBtn" type="button">‚¨áÔ∏è Scarica PNG con numerini</button>
        <button class="barBtn" id="saveGithubBtn" type="button">‚òÅÔ∏è Salva su GitHub (token)</button>
        <button class="barBtn danger" id="closeEditBtn" type="button">Chiudi</button>
      </div>

      <div style="margin-top:10px">
        <div class="smallHint2" id="saveResult" style="opacity:.95"></div>
      </div>
    </div>
  </div>

  <script src="app.js?v=1"></script>
</body>
</html>
