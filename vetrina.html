<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SerCucTech â€“ Vetrina</title>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:#0b1220;
  color:#e8eefc;
}
.wrap{
  max-width:1000px;
  margin:auto;
  padding:16px;
}
.card{
  background:#111b2e;
  border-radius:18px;
  padding:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
h1{margin:0 0 10px 0}
.mut{color:#a9b8dd}
.media{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:12px;
  margin-top:16px;
}
.media img, .media video{
  width:100%;
  border-radius:12px;
  background:#000;
}
.files{
  margin-top:16px;
  display:grid;
  gap:8px;
}
.files a{
  display:block;
  padding:10px 12px;
  background:#0f1a31;
  border-radius:12px;
  color:#9fe9ff;
  text-decoration:none;
}
.files a:hover{background:#16254a}

.guide-box{
  margin-top:14px;
  padding:12px;
  border:2px dashed #5ee1a2;
  border-radius:14px;
  background:#0f1a31;
}
.guide-box button{
  border:0;
  padding:12px 16px;
  border-radius:12px;
  font-weight:800;
  background:#5ee1a2;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <h1 id="title">Vetrina</h1>
    <div class="mut" id="description"></div>

    <!-- GUIDA PASSO PASSO (solo se abilitata) -->
    <div id="publicGuide" class="guide-box" style="display:none">
      <div class="mut" style="margin-bottom:6px">
        Hai bisogno di aiuto? Segui la guida passo-passo.
      </div>
      <button onclick="openGuide()">ðŸ“˜ Guida passo-passo</button>
    </div>

    <!-- MEDIA -->
    <div class="media" id="media"></div>

    <!-- FILES -->
    <div class="files" id="files"></div>
  </div>
</div>

<script>
/* ================= PARAM ================= */
const params = new URL(location.href).searchParams;
const VETRINA_ID = params.get("id") || "scalvini10";

/* ================= LOAD JSON ================= */
fetch(`data/${VETRINA_ID}.json?t=` + Date.now())
  .then(r => {
    if(!r.ok) throw new Error("Vetrina non trovata");
    return r.json();
  })
  .then(v => initVetrina(v))
  .catch(err => {
    document.getElementById("title").textContent = "Vetrina non trovata";
    document.getElementById("description").textContent = err.message;
  });

/* ================= INIT ================= */
function initVetrina(v){
  // titolo e descrizione
  document.getElementById("title").textContent = v.title || v.id;
  document.getElementById("description").textContent = v.description || "";

  /* ===== GUIDA ===== */
  if(v.showGuide === true){
    document.getElementById("publicGuide").style.display = "block";
  }

  /* ===== MEDIA ===== */
  const mediaBox = document.getElementById("media");
  (v.media || []).forEach(m => {
    if(m.type === "image"){
      const img = document.createElement("img");
      img.src = m.url;
      img.alt = m.title || "";
      mediaBox.appendChild(img);
    }
    if(m.type === "video"){
      const vid = document.createElement("video");
      vid.src = m.url;
      vid.controls = true;
      mediaBox.appendChild(vid);
    }
  });

  /* ===== FILES ===== */
  const filesBox = document.getElementById("files");
  (v.files || []).forEach(f => {
    const a = document.createElement("a");
    a.href = f.url;
    a.target = "_blank";
    a.textContent = "ðŸ“„ " + (f.label || f.url);
    filesBox.appendChild(a);
  });
}

/* ================= OPEN GUIDE ================= */
function openGuide(){
  window.open(`checklist.html?id=${VETRINA_ID}`, "_blank");
}
</script>
</body>
</html>
