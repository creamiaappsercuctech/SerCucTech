<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SerCucTech â€“ Vetrine</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b1220">
  <link rel="apple-touch-icon" href="icon-192.png">

  <link rel="stylesheet" href="stile.css" />
  <style>
    .topbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    .search{flex:1;min-width:220px}
    .search input{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #22345f;background:#0f1b33;color:#e8eefc}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border-radius:999px;border:1px solid #22345f;background:#0f1b33}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="topbar">
        <div>
          <h1 style="margin:0">SerCucTech â€“ Vetrine</h1>
          <div class="mut">Lista pubblica letta da <span class="mono">data/index.json</span></div>
        </div>

        <div class="pill">
          <a class="btn sec" href="admin.html">ğŸ” Admin</a>
          <a class="btn sec" href="pubblica.html">ğŸ“£ Pubblica</a>
        </div>
      </div>

      <div style="height:10px"></div>

      <div class="search">
        <input id="q" type="search" placeholder="Cerca per titolo, id o tagâ€¦ (es: scalvini, casa, manuale)" autocomplete="off">
      </div>

      <div class="mut" style="margin-top:10px" id="status"></div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 8px 0">Vetrine</h2>
      <div id="list"></div>
    </div>

    <div class="mut" style="margin-top:14px">
      Suggerimento: apri una vetrina con <span class="mono">vetrina.html?id=scalvini10</span> oppure un gruppo con <span class="mono">vetrina.html?group=scalvini</span>.
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    // PWA
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./service-worker.js").catch(console.error);
    }

    // Filtro ricerca (usa il DOM giÃ  renderizzato da app.js)
    (function(){
      const q = document.getElementById("q");
      const status = document.getElementById("status");
      const list = document.getElementById("list");

      function norm(s){ return String(s||"").toLowerCase(); }

      function applyFilter(){
        const term = norm(q.value).trim();
        if(!term){
          status.textContent = "";
          Array.from(list.querySelectorAll(".item")).forEach(it=>it.style.display="");
          return;
        }
        let shown = 0;
        Array.from(list.querySelectorAll(".item")).forEach(it=>{
          const txt = norm(it.textContent);
          const ok = txt.includes(term);
          it.style.display = ok ? "" : "none";
          if(ok) shown++;
        });
        status.textContent = `Filtro attivo: ${shown} risultati per â€œ${term}â€`;
      }

      q.addEventListener("input", applyFilter);
    })();
  </script>
</body>
</html>
