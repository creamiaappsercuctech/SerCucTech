<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin â€“ Vetrine</title>

<style>
body {
  margin: 0;
  background: #0b1020;
  color: white;
  font-family: system-ui, sans-serif;
}

.container {
  padding: 16px;
}

input, textarea, button {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  border-radius: 8px;
  border: none;
}

button {
  background: #2563eb;
  color: white;
  font-weight: bold;
}

.card {
  background: #111827;
  padding: 12px;
  border-radius: 12px;
  margin-bottom: 14px;
}
.small {
  font-size: 13px;
  color: #9ca3af;
}
</style>
</head>

<body>
<div class="container">
  <h2>Gestione Vetrine</h2>

  <div class="card">
    <input id="vid" placeholder="ID vetrina (es: negozio1)">
    <input id="title" placeholder="Titolo">
    <textarea id="desc" placeholder="Descrizione"></textarea>
    <input type="file" id="files" multiple>
    <button onclick="save()">Salva / Aggiorna vetrina</button>
  </div>

  <h3>Vetrine esistenti</h3>
  <div id="list"></div>
</div>

<script>
const KEY = 'vetrine-sercuctech';
let vetrine = JSON.parse(localStorage.getItem(KEY) || '{}');

function save() {
  const id = vid.value.trim();
  if (!id) return alert("ID obbligatorio");

  const files = [...filesInput.files].map(f => ({
    name: f.name,
    url: URL.createObjectURL(f),
    type: f.type
  }));

  vetrine[id] = {
    title: title.value,
    desc: desc.value,
    files: (vetrine[id]?.files || []).concat(files)
  };

  localStorage.setItem(KEY, JSON.stringify(vetrine));
  render();
}

function render() {
  list.innerHTML = '';
  Object.keys(vetrine).forEach(id => {
    const v = vetrine[id];
    const link = `${location.origin}${location.pathname.replace('admin.html','vetrine.html')}?id=${id}`;

    const d = document.createElement('div');
    d.className = 'card';
    d.innerHTML = `
      <b>${v.title || id}</b>
      <div class="small">${v.desc || ''}</div>
      <div class="small">Link pubblico:</div>
      <a href="${link}" target="_blank">${link}</a>
      <button onclick="del('${id}')">Elimina</button>
    `;
    list.appendChild(d);
  });
}

function del(id) {
  if (!confirm("Eliminare vetrina?")) return;
  delete vetrine[id];
  localStorage.setItem(KEY, JSON.stringify(vetrine));
  render();
}

render();
</script>
</body>
</html>
