<script>
const loginBox = document.getElementById("login");
const panelBox = document.getElementById("panel");
const pinInput = document.getElementById("pin");

let uploaded = [];

// PIN di default (puoi cambiarlo)
if (!localStorage.getItem("admin_pin")) {
  localStorage.setItem("admin_pin", "1234");
}

function login(){
  const savedPin = localStorage.getItem("admin_pin");

  if(pinInput.value === savedPin){
    loginBox.style.display = "none";
    panelBox.style.display = "block";
  } else {
    alert("❌ PIN errato");
  }
}

function addFiles(){
  const filesInput = document.getElementById("files");
  const status = document.getElementById("status");

  [...filesInput.files].forEach(file=>{
    const reader = new FileReader();
    reader.onload = () => {
      uploaded.push({
        name: file.name,
        type: file.type,
        data: reader.result
      });
      status.textContent = "File caricati: " + uploaded.length;
    };
    reader.readAsDataURL(file);
  });
}

function save(){
  const vid = document.getElementById("vid").value;
  if(!vid){
    alert("Inserisci ID vetrina");
    return;
  }

  const data = JSON.parse(localStorage.getItem("vetrine") || "{}");

  data[vid] = {
    title: document.getElementById("title").value,
    desc: document.getElementById("desc").value,
    titleSize: document.getElementById("titleSize").value,
    titleColor: document.getElementById("titleColor").value,
    bgColor: document.getElementById("bgColor").value,
    bgImage: document.getElementById("bgImage").files[0]
      ? URL.createObjectURL(document.getElementById("bgImage").files[0])
      : null,
    files: uploaded
  };

  localStorage.setItem("vetrine", JSON.stringify(data));

  alert(
    "✅ Vetrina salvata!\n\nLink pubblico:\n" +
    "index.html?vetrina=" + vid
  );
}
      </script>
