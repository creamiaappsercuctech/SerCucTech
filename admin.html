<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Admin</title>
  <link rel="stylesheet" href="stile.css?v=4000">
  <style>
    .wrap{padding:14px}
    .gate{max-width:560px; margin:12px auto; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04); border-radius:18px; padding:14px}
    .words{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    .wordBtn{
      flex:1;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      color:#fff;
      font-weight:900;
      font-size:18px;
    }
    .wordBtn.ok{outline:2px solid rgba(56,210,122,.65)}
    .row{display:flex; gap:10px; margin-top:12px}
    input{
      width:100%;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.20);
      color:#fff;
      font-size:20px;
      font-weight:800;
      letter-spacing:.12em;
    }
    .hidden{display:none !important}
    .mini{opacity:.65; font-size:12px; margin-top:10px; user-select:none}
  </style>
</head>

<body>
<header class="topbar">
  <div class="topbar-inner">
    <div class="brandDot" aria-hidden="true"></div>
    <div class="titleWrap">
      <h1 class="pageTitle">üîí Admin</h1>
      <p class="pageDesc"></p>
    </div>
  </div>
</header>

<main class="wrap">
  <div class="gate" id="gate">
    <div class="words">
      <button class="wordBtn" id="w1" type="button">SerCucTech</button>
      <button class="wordBtn" id="w2" type="button">qualsiasi</button>
    </div>

    <div class="row">
      <input id="pin" placeholder="PIN" inputmode="numeric" autocomplete="one-time-code" />
    </div>

    <!-- Niente istruzioni. Solo un micro-indicatore invisibile ‚Äúutile‚Äù (puoi anche cancellarlo) -->
    <div class="mini" id="mini" aria-hidden="true"> </div>
  </div>

  <div class="gate hidden" id="ok">
    <div style="font-weight:900; font-size:18px">‚úÖ OK</div>
  </div>
</main>

<script>
(() => {
  // ===== CONFIG =====
  const ADMIN_PIN = "1234";                 // cambia qui
  const KEY_UNTIL = "adminUnlockedUntil";   // 24h
  const REDIRECT_TO = "link.html";          // dove andare dopo login (puoi mettere admin.html ‚Äúvero‚Äù se vuoi)

  // ===== DOM =====
  const gate = document.getElementById("gate");
  const ok = document.getElementById("ok");
  const w1 = document.getElementById("w1");
  const w2 = document.getElementById("w2");
  const pin = document.getElementById("pin");

  let step = 0;          // 0=none, 1=first ok, 2=phrase ok
  let phraseOK = false;
  let redirecting = false;

  function isUnlocked() {
    const until = Number(localStorage.getItem(KEY_UNTIL) || "0");
    return Date.now() < until;
  }

  function setUnlocked24h() {
    localStorage.setItem(KEY_UNTIL, String(Date.now() + 24 * 60 * 60 * 1000));
  }

  function go() {
    if (redirecting) return;
    redirecting = true;
    gate.classList.add("hidden");
    ok.classList.remove("hidden");
    // piccola pausa per dare feedback
    setTimeout(() => {
      location.href = REDIRECT_TO;
    }, 180);
  }

  // Auto-pass se gi√† sbloccato
  if (isUnlocked()) {
    go();
    return;
  }

  // ===== ‚Äú2 parole‚Äù in sequenza =====
  w1.addEventListener("click", () => {
    step = 1;
    phraseOK = false;
    w1.classList.add("ok");
    w2.classList.remove("ok");
    tryAutoLogin();
  });

  w2.addEventListener("click", () => {
    if (step === 1) {
      step = 2;
      phraseOK = true;
      w2.classList.add("ok");
      tryAutoLogin();
      // focus PIN appena frase ok
      setTimeout(() => pin.focus(), 50);
    } else {
      // ordine sbagliato: reset silenzioso
      step = 0;
      phraseOK = false;
      w1.classList.remove("ok");
      w2.classList.remove("ok");
    }
  });

  // ===== Auto-login sul PIN =====
  function tryAutoLogin() {
    if (!phraseOK) return;
    const val = (pin.value || "").trim();
    if (val.length < ADMIN_PIN.length) return;
    if (val === ADMIN_PIN) {
      setUnlocked24h();
      go();
    } else {
      // PIN errato: feedback minimo
      if (navigator.vibrate) navigator.vibrate([80, 40, 80]);
      pin.value = "";
      pin.focus();
    }
  }

  pin.addEventListener("input", () => {
    // solo numeri (pulizia)
    pin.value = pin.value.replace(/[^\d]/g, "");
    tryAutoLogin();
  });

  pin.addEventListener("keydown", (e) => {
    // se l‚Äôutente preme invio comunque funziona
    if (e.key === "Enter") {
      e.preventDefault();
      tryAutoLogin();
    }
  });

})();
</script>
</body>
</html>
